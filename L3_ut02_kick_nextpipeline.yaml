---
# L3_ut02_kick_nextpipeline
# Parameter:
# * seq, test_id, test_result_seq
- name: Select Next Pipeline
  debug:
    var: next_pipeline
  vars:
    next_pipeline: '{{ pipeline_vars.pipelines | selectattr("seq", "defined") | selectattr("seq", "eq", seq + 1) }}'
  register: search_result

- name: If type == environment
  debug:
    msg: 'type={{ item.seq }}, seq={{ item.seq }}, name={{ item.name }}, test_result_seq={{ test_result_seq }}, test_id={{ test_id }}'
  with_items: '{{ search_result.next_pipeline }}'
  when: item.type == "environment"

- name: If type == test_scenario
  debug:
    msg: 'type={{ item.seq }}, seq={{ item.seq }}, name={{ item.name }}, test_result_seq={{ test_result_seq }}, test_id={{ test_id }}'
  with_items: '{{ search_result.next_pipeline }}'
  when: item.type == "test_scenario"

- name: If type == closing
  debug:
    msg: 'type={{ item.seq }}, seq={{ item.seq }}, name={{ item.name }}, test_result_seq={{ test_result_seq }}, test_id={{ test_id }}'
  with_items: '{{ search_result.next_pipeline }}'
  when: item.type == "closing"
